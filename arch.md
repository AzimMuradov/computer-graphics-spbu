## Выбор инструментов
Для решения задачи были выбраны языки программирования C и Python, а также фреймворки [OpenGL](https://www.opengl.org) и [PyQt](https://www.riverbankcomputing.com/software/pyqt/).

OpenGL является кроссплатформенным, независимым от языка программирования популярным API для работы с графикой. Каждый участник команды имел разную операционную систему (Windows, Linux, MacOS),
поэтому выбор данного фреймворка был приоритетным. 

Нам не хотелось сильно терять в производительности алгоритма, поэтому были выбраны языки C и Python с библиотекой PyQt, так как C легко интегрируем в Python с помощью библиотеки [cffi](https://cffi.readthedocs.io/en/stable/).

## Алгоритм
Для реализации взаимодействия котов, нужно было использовать алгоритм для поиска ближнего объекта (точки) на плоскости. В нашем проекте был выбран алгоритм KD-Tree с готовой [реализацией](https://github.com/jtsiomb/kdtree) на яыке C.
## Архитектура проекта
Проект поделен на два модуля — frontend и backend. 

Основной файл для запуска ```main.py```вызывает класс ```Core``` из фронтендской части. Перед вызовом функции нужно скомпилировать командой ```make```. CLI принимает аргументы, подробнее можно ознакомиться [здесь](https://github.com/AzimMuradov/drunk-cats/blob/b0da26a319f49daa6fc5a5c8f12a5fd7af6b9895/frontend/core/core.py#L42).
### Backend
Весь бекенд реализован на языке C и отвечает за главную логику взаимодействия котов
- ```third-party/kdtree``` — реализация библиотеки для работы с kd-деревьями.
- ```utils-opengl.c``` — содержит функцию, преобразующую позиции котов из системы координат OpenGL в упрощённые одномерные координаты. Каждая точка _{x, y}_ из OpenGL переводится в пиксельные координаты с учётом масштаба.
- ```utils-random.c``` — содержит функцию, генерирующую случайное значение типа double в диапазоне [0.0, 1.0].
- ```library.c``` — библиотека, моделирующая поведение "пьяных котов" с использованием kd деревьев.
  - ```drunk_cats_configure()``` настраивает глобальные радиусы взаимодействия (драки и шипения).
  - ```drunk_cats_calculate_states()``` функция, вычисляющая состояния котов на основе их позиций.
  - ```drunk_cats_free_states()``` освобождает память, выделенную для массива состояний.
### Frontend
Frontend делится на две логические части — ```Core``` и ```UI```, а ```constants.py``` содержит настройки для рендеринга
#### Core
Данный модуль управляет визуализацией движения "пьяных котов" с интеграцией бекенда, реализованным на C.
- Инициализируется глобальный логгер
- ```Backend``` описывает интерфейс функций, предоставляемых бекендом:
  - ```drunk_cats_configure``` задаёт радиусы взаимодействия для драки и шипения.
  - ``` drunk_cats_calculate_states``` рассчитывает состояния котов на основе их позиций.
  - ```drunk_cats_free_states``` освобождает память, выделенную для массива состояний.
- ```ArgumentParser``` предоставляет аргументы командной строки.
- ```Core``` основной класс приложения, непосредственно обеспечивающий интеграцию бекенда на C и предоставляющий графический интерфейс.
#### UI
Данный модуль предоставляет взаимодействием с пользовательским интерфейсом, обновляет состояния объектов и рендерит их на экране
- ```InputHandler``` обрабатывает события ввода пользователя, такие как движение мыши и прокрутка колесика
- ```RenderState``` содержит состояния рендеринга (points, states, zoom_factor) и т.д
- ```PointRenderer``` настраивает шейдеры и управляет отображением точек
- ```Core``` интерфейс, описывает метод ```update_states```, который обновляет состояния точек на основе их позиций и размеров окна.
- ```UpdateStatesWorker``` асинхронно обновляет состояния точек.
- ```CanvasState``` хранит состояние канваса (zoom_factor, speed_factor и т.д)
## Тестирование
Тесты описаны в директории ```tests/test_drunk_cats_calculate_states.py```
Тесты ниже проверяют различные сценарии взаимодействий между кошками (шипение, борьба)
- ```test_single_cat``` тестирует поведение одной кошки. Проверяется, что кошка не взаимодействует с другими (состояние должно быть 0, что обозначает спокойное состояние).
- ```test_two_cats_no_interactions```
- ```test_two_cats_both_hiss```
- ```test_two_cats_both_fight```
- ```test_three_cats_two_fight_one_hiss```
- ```test_four_cats_all_fighting```